--retrive list of unique countries

select distinct country
from gold_1.dim_customers

--show the first and lasst order and duration of months

select * from gold_1.dim_customers

select min(order_date) as first_order,
max(order_date) as last_order,
datediff(month,min(order_date),max(order_date)) as month_diff
from gold_1.fact_sales

---find the youngest and oldest customer based on birthdate

select min(birthdate) as oldest_customer,
max(birthdate) as youngest_customer,
DATEDIFF(year,min(birthdate),current_date) as age_1,
DATEDIFF(year,max(birthdate),current_date) as age_2
from gold_1.dim_customers

--total customer by country
select country,count(*) as total_customers
from gold_1.dim_customers
group by country
order by count(*) desc

--find total customer by gender
--find total products by category

select gender,count(customer_id) as total_count
from gold_1.dim_customers
group by gender
order by count(customer_id) desc


select category,count(product_key) as total_products
from gold_1.dim_products
group by category
order by count(product_key) desc



-- what is the avg and total revenue generated by each category

select p.category,avg(p.cost) as avg_revenue,
sum(s.sales_amount) as total_revenue
from gold_1.dim_products p
left join gold_1.fact_sales s on s.product_key=p.product_key
group by p.category


--what is the total revenue generated by eeach customer

select c.customer_key,c.first_name,
sum(s.sales_amount) as total_sales
from gold_1.dim_customers c
left join gold_1.fact_sales s on c.customer_key=s.customer_key
group by c.customer_key,c.first_name
order by total_sales desc


--what is the distribution of sold items across countries

select c.country,
sum(s.quantity) as total_quantity
from gold_1.dim_customers c
left join gold_1.fact_sales s on c.customer_key=s.customer_key
group by c.country



